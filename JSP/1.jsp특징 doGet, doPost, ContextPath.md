jsp 문서 작성하기

### jsp특징

- **동적 웹어플리케이션 컴포넌트**

- jsp확장자

- 클라이언트의 요청에의해 동적으로 작동하고 응답은 html을 ㅣㅇ용

- jsp는 <u>서블릿으로 변환</u> ( tomcat 서버가 변환 ) 되어 실행

- MVC패턴에서view로 이용됨

  - 웹페이지 -> request -> <u>C</u>ontroller(servelt) <-> <u>M</u>odel

    ​																	 --> <u>V</u>iew (JSP)---response -> 웹페이지

### JSP 아키텍쳐

- .jsp file (helloworld.jsp) -- (java 파일로 변환) --> Java file (helloworld_jsp.java)---(컴파일)--->class file (helloworld_jsp.class)
  - ![](C:\Users\HK\AppData\Roaming\Typora\typora-user-images\1561795540557.png)

Servlet문서 작성하기

### Servlet 특징

- 동적 웹어플리케이션 컴포넌트
- .java확장자
- 클라이언트 요청에 의해 동적으로 작동, html로 응답
- java thread 이용해 동작
- MVC 패턴에서 Controller로 이용됨

### Mapping

- 너무 길고, 보안에 노출되어 있는 경로를 간단하게 하기 위해 맵핑하는 것

  - http://localhost:8181/helloworld/servlet/com.javalec.ex.Helloworld
    servlet/com.javalec.ex.Helloworld --> Hworld로 맵핑

- 맵핑하는 방법 

  - 1) servlet-name 태그 이용

  ```xml
  <servlet>
    <servlet-name>Helloworld</servlet-name>
    <servlet-class>com.javalec.ex.Helloworld</servlet-class>
    </servlet>
    
    <servlet-mapping>
    <servlet-name>Helloworld</servlet-name>
    <url-pattern>/hw</url-pattern>
    </servlet-mapping>
  ```

  결과 : http://localhost:8181/hello/hw

  - 2) 해당 클래스에 어노테이션 이용

    ```java
    @WebServlet({"/Hworld" })
    ```

    결과 : http://localhost:8181/hello/Hworld



### 요청처리 객체 및 응답처리 객체를 톰캣에서 받음

client ---------request 1.( ID, PW )----------------------> WAS(tomcat) 2. DB 검색
         < --------response 3.(회원 여부 결과)------------

response.setContentType("text/html")
PrintWriter writer = response.getWrite();   < ---  웹 브라우저에 출력하기 위한 스트림

### doGet, doPost

client -------------request------------------------------->WAS 

request 방식 2가지 
 : client에서 html태그 안에서 정할 수 있음

1. get방식 doGet()

   - HTML문서 내 method 속성값 = get

   - URL값으로 정보가 전송되어 보안에 약함

   - 웹브라우저의 주소창을 이용해 servlet을 요청한 경우에도 호출된다.

   - doGet()메서드는 매개변수로HttpServletRequest,HttpServletResponse를 받음

     - HttpServletRequest >클라이언트 요청 처리 객체
       HttpServletResponse > 클라이언트 응답처리 객체

   - ```java
     protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
     		System.out.println("doGet");
     		response.setContentType("text/html charset=utf-8");
     		PrintWriter writer = response.getWriter();
     		
     		writer.println("<html>");
     		writer.println("<head>");
     		writer.println("</head>");
     		writer.println("<body>");
     		writer.println("hellow world");
     		writer.println("</body>");
     		writer.println("</html>");
     		
     		writer.close();	
     	}
     ```

     .![](C:\Users\HK\Pictures\doget.PNG)

     

     

2. post방식 doPost()

   - html 태그 내에서 메서드가 post일 경우 호출됨

   - HTML문서 내 method 속성값 = post

   - header를 이용해 전송되어 보안에 강함

   - ```html
     <!DOCTYPE html>
     <html>
     <head>
     <meta charset="UTF-8">
     <title>Insert title here</title>
     </head>
     <body>
     <form action = "Postmethod" method = "post">
     <input type = "submit" value = "post">
     </form>
     </body>
     </html>
     ```

   - ```java
     protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
     		System.out.println("doPost");
     		response.setContentType("text/html; charset=utf-8");
     		PrintWriter writer = response.getWriter();
     		
     		writer.println("<html>");
     		writer.println("<head>");
     		writer.println("</head>");
     		writer.println("<body>");
     		writer.println("<h1>POST 방식입니다 따라서getPost메소드가 호출 되었습니다.</h1>");
     		writer.println("</body>");
     		writer.println("</html>");
     		
     		writer.close();	
     	}
     ```

     ![](C:\Users\HK\Pictures\dopost.PNG)

3. ### 컨텍스트 패스 

   WAS에서 웹 어플리케이션을 구분하기 위한 Path
   이클립스에서 프로젝트 생성 시 자동으로 server.xml에 추가된다.

---

### Servlet 작동 순서

클라이언트에서 servlet 요청이 들어오면 서버에서는 servlet컨테이너를 만들고 요청이 있을 때마다 스레드가 생성된다.

웹 브라우저 ---->  웹 서버 ------>WAS ------> Servlet 컨테이너 (스레드 생성, servlet 객체 생성)

### Servlet 라이프 사이클

- 서블릿의 사용도가 높은 이유는 빠른 응답 속도 때문

- 최초 요청시 객체가 만들어져 메모리에 로딩되고, 이후 요청 시에는 기존의 객체를 재활용하여 동작 속도가 빠름

  Servlet 객체 생성 	/최초 한번
     |
  nit() 호출 	/최초 한번
     |
  service(), doGet(), doPost( ) 호출  	/요청시 매번
     |
  destroy () 호출 	/마지막 한번

### 선처리, 후처리

Servlet 객체 생성
		|

​				<u>전처리 : @ PostConstruct()</u>

​		|
Init() 호출
​		|
service(), doGet(), doPost() 호출
​		|
destroy()호출
​		|		 
​				<u>후처리 : @preDestroy</u>

### HTML form태그

form 태그는 서버쪽으로 정보를 전달할 때 사용하는 태그

- input

  - 속성 (type, name, value)
    - type : 태그 종류 지정 (text, submit, password, checkbox, radio, reset)
    - name : input 태그 이름
    - value : name에 해당하는 값

- type = text

  일반적인 데이터를 입력하기 위해 사용

  <input type="text" name="name" size="10">

- type = password

  로그인, 회원가입 페이지 등에서 비밀번호 입력

  <input type="password" name="name" size="10">

- type = submit

  <input type="submit" value="전송">

- type = reset

  <input type="reset" value="초기화">

- type = checkbox
  name은 다 같고 value값만 다르다

  <input type="checkbox" name="hobby" value="read"> 독서 
  <input type="checkbox" name="hobby" value="swim"> 수영

- type = radio
  한 개의 값만 전송할 때 사용

  <input type="checkbox" name="major" value="kor"> 국어 
  <input type="checkbox" name="major" value="eng" checked=:"checked"> 영어  checked는 초기 체크됨

- select 

  리스트 형태의 데이터 사용 	  

  <select name="protocol">
      <option value="http">http</option>
      <option value="ftp">ftp</option>
      <option value="smtp">smtp</option>
  </select>

- form 태그 

  input의 태그 값들을 서버로 전송하기 위한 정보를 담는다

  ```html
  <form ation="FormEx" method="post">
  ```

  FormEx : 요청하는 컴포넌트 이름 (ex. join.jsp, info.html)

### Servlet Parameter

Form태그의 submit 버튼을 클릭해 데이터를 서버로 전송하면 해당 파일(servlet) 에서는 HttpServletRequest객체를 이용해 Parameter값을 얻을 수 있다.

HTML파일-------------------------------->Servlet파일
<form'>												getParameter(name)
<input type="submit" value="전송"'>  getParameterValues(name)
</form'>												getParameterName()

### 한글처리

- Get방식 요청

  <servre.xml 수정>
  <'Connector URIEncoding="EUC-KR" port="8181",,,,>

- Post방식 요청

  서블릿에 	request.setCharacterEncoding("UTF-8")



